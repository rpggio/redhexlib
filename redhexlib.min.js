var Cube=function(e,t,n){this.v=[e,t,n]};Cube._directions=[[1,-1,0],[1,0,-1],[0,1,-1],[-1,1,0],[-1,0,1],[0,-1,1]];Cube.prototype={toString:function(){return this.v.join(",")},equals:function(e){return this.v[0]==e.v[0]&&this.v[1]==e.v[1]&&this.v[2]==e.v[2]},scale:function(e){return new Cube(e*this.v[0],e*this.v[1],e*this.v[2])},add:function(e){return new Cube(this.v[0]+e.v[0],this.v[1]+e.v[1],this.v[2]+e.v[2])},subtract:function(e){return new Cube(this.v[0]-e.v[0],this.v[1]-e.v[1],this.v[2]-e.v[2])},rotateLeft:function(){return new Cube(-this.v[1],-this.v[2],-this.v[0])},rotateRight:function(){return new Cube(-this.v[2],-this.v[0],-this.v[1])},length:function(){var e=0;var t=0;while(t<3){var n=t++;if(Math.abs(this.v[n])>e)e=Math.abs(this.v[n])}return e},round:function(){var e=[];var t=0;var n=0;while(n<3){var r=n++;e[r]=Math.round(this.v[r]);t+=e[r]}if(t!==0){var i=[];var s=0;var o=0;while(o<3){var u=o++;i[u]=Math.abs(e[u]-this.v[u]);if(i[u]>i[s])s=u}e[s]=-t+e[s]}return new Cube(e[0],e[1],e[2])},toHex:function(){return new Hex(this.v[0]||0,this.v[2]||0)}};var Grid=function(e,t,n){this.scale=e;this.orientation=t;this.hexes=n};Grid.SQRT_3_2=Math.sqrt(3)/2;Grid.boundsOfPoints=function(e){var t=0,n=0,r=0,i=0;var s=0;while(s<e.length){var o=e[s];++s;if(o.x<t)t=o.x;if(o.x>r)r=o.x;if(o.y<n)n=o.y;if(o.y>i)i=o.y}return{minX:t,maxX:r,minY:n,maxY:i}};Grid.hexagonalShape=function(e){var t=[];var n=-e,r=e+1;while(n<r){var i=n++;var s=-e,o=e+1;while(s<o){var u=s++;var a=-i-u;if(Math.abs(i)<=e&&Math.abs(u)<=e&&Math.abs(a)<=e)t.push(new Cube(i,u,a))}}return t};Grid.prototype={hexToCenter:function(e){if(this.orientation){return new ScreenCoordinate(this.scale*Grid.SQRT_3_2*(e.v[0]+.5*e.v[2]),this.scale*.75*e.v[2])}return new ScreenCoordinate(this.scale*.75*e.v[0],this.scale*Grid.SQRT_3_2*(e.v[2]+.5*e.v[0]))},bounds:function(){var e=this;var t=this.hexes.map(function(t){return e.hexToCenter(t)});var n=Grid.boundsOfPoints(this.polygonVertices());var r=Grid.boundsOfPoints(t);return{minX:n.minX+r.minX,maxX:n.maxX+r.maxX,minY:n.minY+r.minY,maxY:n.maxY+r.maxY}},polygonVertices:function(){var e=[];var t=0;while(t<6){var n=t++;var r=2*Math.PI*(2*n-(this.orientation?1:0))/12;e.push(new ScreenCoordinate(.5*this.scale*Math.cos(r),.5*this.scale*Math.sin(r)))}return e}};var Hex=function(e,t){this.q=e;this.r=t};Hex.prototype={toString:function(){return this.q+":"+this.r},toCube:function(){return new Cube(this.q,-this.r-this.q,this.r)}};var ScreenCoordinate=function(e,t){this.x=e;this.y=t};ScreenCoordinate.prototype={equals:function(e){return this.x==e.x&&this.y==e.y},toString:function(){return this.x+","+this.y},length_squared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.length_squared())},normalize:function(){var e=this.length();return new ScreenCoordinate(this.x/e,this.y/e)},scale:function(e){return new ScreenCoordinate(this.x*e,this.y*e)},rotateLeft:function(){return new ScreenCoordinate(this.y,-this.x)},rotateRight:function(){return new ScreenCoordinate(-this.y,this.x)},add:function(e){return new ScreenCoordinate(this.x+e.x,this.y+e.y)},subtract:function(e){return new ScreenCoordinate(this.x-e.x,this.y-e.y)},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},distance:function(e){return this.subtract(e).length()}};var Shape=function(){};Shape.hexagon=function(e,t,n,r){var i=[];for(var s=0;s<6;s++){var o=2*Math.PI*(2*s-r)/12;i.push(new ScreenCoordinate(t+.5*e*Math.cos(o),n+.5*e*Math.sin(o)))}return i}